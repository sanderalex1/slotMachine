<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link rel="stylesheet" href="style.css" />
  <script src="app.js" defer></script>
  <script defer>
    let bet = 1;
    let balance = 100;
    let pl = 0;

    let elements = {};

    setTimeout(() => {
      elements = {
        win: document.getElementById("win"),
        balance: document.getElementById("balance"),
        bet: document.getElementById("bet"),
        spin: document.getElementById("spin"),

        cherriesPayout: document.getElementById("cherriesPayout"),
        bananasPayout: document.getElementById("bananasPayout"),
        grapesPayout: document.getElementById("grapesPayout"),
        watermelonsPayout: document.getElementById("watermelonsPayout"),
        bellsPayout: document.getElementById("bellsPayout"),
        lucky7sPayout: document.getElementById("lucky7sPayout"),
        starsPayout: document.getElementById("starsPayout"),
      };
      console.log(elements);
    }, 1);

    function symbolValue(symbol) {
      return 1 + Math.floor(Math.random() * 10);
    }

    function updatePayoutTable() {
      console.log(elements);
      elements.cherriesPayout.textContent = symbolValue("cherries");
      elements.bananasPayout.textContent = symbolValue("bananas");
      elements.grapesPayout.textContent = symbolValue("grapes");
      elements.watermelonsPayout.textContent = symbolValue("watermelons");
      elements.bellsPayout.textContent = symbolValue("bells");
      elements.lucky7sPayout.textContent = symbolValue("lucky7s");
      elements.starsPayout.textContent = symbolValue("stars");
    }

    function handleIncreaseBet() {
      bet++;
      if (bet > 10) bet = 1;
      elements.bet.textContent = bet;
      updatePayoutTable();
    }

    async function handleSpin() {
      elements.spin.disabled = true;
      const result = spin();
      console.log(result);

      const slots = Array.from(document.querySelectorAll('.slot'));
      // start spinning (downwards) and blur only those reels
      slots.forEach(slot => slot.classList.add('is-spinning'));

      // staggered stop: right reels keep spinning longer
      for (let i = 0; i < slots.length; i++) {
        const slot = slots[i];
        const delay = 400 + Math.random() * 500; // 400-900ms extra per reel
        await new Promise(resolve => setTimeout(resolve, i === 0 ? 700 : delay));

        // stop this reel
        slot.classList.remove('is-spinning');

        // replace content to show only the landed symbol for this reel
        const track = slot.querySelector('.slot-track');
        if (!track) continue;
        const symbolCode = result[i];
        const map = { C: 'cherries', b: 'bananas', G: 'grapes', W: 'watermelon', B: 'bells', L: 'lucky7s', S: 'stars' };
        const name = map[symbolCode];
        if (!name) continue;
        track.innerHTML = `
          <div class="symbol-wrap">
            <img class="symbol symbol--normal" src="img/${name}.webp" alt="${name}">
            <img class="symbol symbol--blur" src="img/${name}-blur.webp" alt="${name} blurred" aria-hidden="true">
          </div>
        `;
      }

      // all reels stopped
      elements.spin.disabled = false;

      // Handle Spin payout
      let payout = 0;
      elements.win.textContent = "";
      if (isWinner(result)) {
        payout = bet * symbolValue(result[0]);
        balance += payout;
        elements.win.textContent = payout;
      }
    }

    updatePayoutTable();
  </script>
</head>

<body>
  <main>
    <section class="slot-machine-payout-table">
      <h2>Payout Table</h2>
      <table>
        <colgroup>
          <col class="col-symbol">
          <col class="col-payout">
        </colgroup>
        <thead>
          <tr>
            <th>Symbol</th>
            <th>Payout</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries">
              </div>
              <span class="symbol-label">Cherries</span>
            </td>
            <td class="payout"><span id="cherriesPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas">
              </div>
              <span class="symbol-label">Bananas</span>
            </td>
            <td class="payout"><span id="bananasPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes">
              </div>
              <span class="symbol-label">Grapes</span>
            </td>
            <td class="payout"><span id="grapesPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons">
              </div>
              <span class="symbol-label">Watermelons</span>
            </td>
            <td class="payout"><span id="watermelonsPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/bells.webp" alt="Bells">
              </div>
              <span class="symbol-label">Bells</span>
            </td>
            <td class="payout"><span id="bellsPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s">
              </div>
              <span class="symbol-label">Lucky-7s</span>
            </td>
            <td class="payout"><span id="lucky7sPayout">0</span></td>
          </tr>
          <tr>
            <td class="symbol-cell">
              <div class="symbol-wrap">
                <img class="symbol symbol--normal" src="img/stars.webp" alt="Stars">
              </div>
              <span class="symbol-label">Stars</span>
            </td>
            <td class="payout"><span id="starsPayout">0</span></td>
          </tr>
        </tbody>
      </table>
    </section>


    <section class="slot-machine-reels">
      <div class="reel">
        <div class="slot">
          <div class="slot-track">
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
            <!-- duplicate for seamless loop -->
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
          </div>
        </div>
      </div>
      <div class="reel">
        <div class="slot">
          <div class="slot-track">
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
            <!-- duplicate for seamless loop -->
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
          </div>
        </div>
      </div>
      <div class="reel">
        <div class="slot">
          <div class="slot-track">
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
            <!-- duplicate for seamless loop -->
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/stars.webp" alt="Stars"><img
                class="symbol symbol--blur" src="img/stars-blur.webp" alt="Stars blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bells.webp" alt="Bells"><img
                class="symbol symbol--blur" src="img/bells-blur.webp" alt="Bells blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/watermelon.webp" alt="Watermelons"><img
                class="symbol symbol--blur" src="img/watermelon-blur.webp" alt="Watermelons blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/grapes.webp" alt="Grapes"><img
                class="symbol symbol--blur" src="img/grapes-blur.webp" alt="Grapes blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/bananas.webp" alt="Bananas"><img
                class="symbol symbol--blur" src="img/bananas-blur.webp" alt="Bananas blurred" aria-hidden="true"></div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/cherries.webp" alt="Cherries"><img
                class="symbol symbol--blur" src="img/cherries-blur.webp" alt="Cherries blurred" aria-hidden="true">
            </div>
            <div class="symbol-wrap"><img class="symbol symbol--normal" src="img/lucky7s.webp" alt="Lucky-7s"><img
                class="symbol symbol--blur" src="img/lucky7s-blur.webp" alt="Lucky-7s blurred" aria-hidden="true"></div>
          </div>
        </div>
      </div>
    </section>


    <section class="slot-machine-bottom-row">
      <div class="balance">
        <p>Balance: <span id="balance">100</span></p>
        <p>Bet: <span id="bet">1</span></p>
        <p>Win: <span id="win"></span></p>
      </div>

      <button class="btn" onclick="handleIncreaseBet()">Increase Bet</button>
      <button class="btn" onclick="handleSpin()" id="spin">Spin</button>
    </section>
  </main>
</body>

</html>